{"version":3,"names":["_imageServiceConstants","require","alignTypeToPosition","verticalMiddle","horizontalMiddle","target","alignTypes","TOP_LEFT","top","left","TOP_RIGHT","right","TOP","BOTTOM_LEFT","bottom","BOTTOM_RIGHT","BOTTOM","RIGHT","LEFT","CENTER","width","height","objectFit","alignTypeToPositionStr","aligmentDefaults","position","getCSS","transformsObj","attributes","css","container","img","fittingType","alignType","alignment","fittingTypes","ORIGINAL_SIZE","LEGACY_ORIGINAL_SIZE","parts","length","src","SCALE_TO_FIT","LEGACY_FIT_WIDTH","LEGACY_FIT_HEIGHT","LEGACY_FULL","objectPosition","LEGACY_BG_NORMAL","STRETCH","SCALE_TO_FILL","Math","round","Object","assign"],"sources":["../../../../src/engines/attributes/imgAttributes.ts"],"sourcesContent":["import { alignTypes, fittingTypes } from '../../helpers/imageServiceConstants';\nimport type { ImageTransformObject, ImageTransformTarget } from '../../types';\n\ntype ImageAttributes = {\n  css: {\n    container: {\n      position?: string;\n    };\n    img: {\n      width?: number | string;\n      height?: number | string;\n      objectFit?: string;\n      objectPosition?: string;\n    };\n  };\n};\n\n/**\n * align type to position\n * @param verticalMiddle\n * @param horizontalMiddle\n * @param target\n * @returns {{}}\n */\nfunction alignTypeToPosition(\n  verticalMiddle: number,\n  horizontalMiddle: number,\n  target: ImageTransformTarget,\n) {\n  return {\n    [alignTypes.TOP_LEFT]: { top: 0, left: 0 },\n    [alignTypes.TOP_RIGHT]: { top: 0, right: 0 },\n    [alignTypes.TOP]: { top: 0, left: horizontalMiddle },\n    [alignTypes.BOTTOM_LEFT]: { bottom: 0, left: 0 },\n    [alignTypes.BOTTOM_RIGHT]: { bottom: 0, right: 0 },\n    [alignTypes.BOTTOM]: { bottom: 0, left: horizontalMiddle },\n    [alignTypes.RIGHT]: { top: verticalMiddle, right: 0 },\n    [alignTypes.LEFT]: { top: verticalMiddle, left: 0 },\n    [alignTypes.CENTER]: {\n      width: target.width,\n      height: target.height,\n      objectFit: 'none',\n    },\n  };\n}\n\nconst alignTypeToPositionStr = {\n  [alignTypes.CENTER]: 'center',\n  [alignTypes.TOP]: 'top',\n  [alignTypes.TOP_LEFT]: 'top left',\n  [alignTypes.TOP_RIGHT]: 'top right',\n  [alignTypes.BOTTOM]: 'bottom',\n  [alignTypes.BOTTOM_LEFT]: 'bottom left',\n  [alignTypes.BOTTOM_RIGHT]: 'bottom right',\n  [alignTypes.LEFT]: 'left',\n  [alignTypes.RIGHT]: 'right',\n};\n\nconst aligmentDefaults = {\n  position: 'absolute',\n  top: 'auto',\n  right: 'auto',\n  bottom: 'auto',\n  left: 'auto',\n};\n\n/**\n * returns image tag CSS data\n * @param {ImageTransformObject}    transformsObj    transform parts object\n * @param {ImageTransformTarget}    target\n *\n * @returns {ImageAttributes}\n */\nfunction getCSS(\n  transformsObj: ImageTransformObject,\n  target: ImageTransformTarget,\n): ImageAttributes {\n  const attributes: ImageAttributes = {\n    css: {\n      container: {},\n      img: {},\n    },\n  };\n  const { css } = attributes;\n  const { fittingType } = transformsObj;\n  const alignType = target.alignment;\n\n  css.container.position = 'relative';\n\n  switch (fittingType) {\n    case fittingTypes.ORIGINAL_SIZE:\n    case fittingTypes.LEGACY_ORIGINAL_SIZE:\n      if (transformsObj.parts && transformsObj.parts.length) {\n        css.img.width = transformsObj.parts[0].width;\n        css.img.height = transformsObj.parts[0].height;\n      } else {\n        css.img.width = transformsObj.src.width;\n        css.img.height = transformsObj.src.height;\n      }\n      break;\n\n    case fittingTypes.SCALE_TO_FIT:\n    case fittingTypes.LEGACY_FIT_WIDTH:\n    case fittingTypes.LEGACY_FIT_HEIGHT:\n    case fittingTypes.LEGACY_FULL:\n      css.img.width = target.width;\n      css.img.height = target.height;\n      css.img.objectFit = 'contain';\n      css.img.objectPosition =\n        alignTypeToPositionStr[alignType as string] || 'unset';\n      break;\n    // BG_NORMAL is a sitebackground legacy for original size fitting type.\n    // target width and height were modified in transform.js\n    case fittingTypes.LEGACY_BG_NORMAL:\n      css.img.width = '100%';\n      css.img.height = '100%';\n      css.img.objectFit = 'none';\n      css.img.objectPosition =\n        alignTypeToPositionStr[alignType as string] || 'unset';\n      break;\n\n    case fittingTypes.STRETCH:\n      css.img.width = target.width;\n      css.img.height = target.height;\n      css.img.objectFit = 'fill';\n      break;\n\n    case fittingTypes.SCALE_TO_FILL:\n      css.img.width = target.width;\n      css.img.height = target.height;\n      css.img.objectFit = 'cover';\n      break;\n  }\n\n  // set alignment in a private case where the image src is smaller than the image container,\n  if (\n    typeof css.img.width === 'number' &&\n    typeof css.img.height === 'number' &&\n    (css.img.width !== target.width || css.img.height !== target.height)\n  ) {\n    const verticalMiddle = Math.round((target.height - css.img.height) / 2);\n    const horizontalMiddle = Math.round((target.width - css.img.width) / 2);\n    Object.assign(\n      css.img,\n      aligmentDefaults,\n      alignTypeToPosition(verticalMiddle, horizontalMiddle, target)[\n        alignType as string\n      ],\n    );\n  }\n\n  return attributes;\n}\n\nexport { getCSS as get };\n"],"mappings":"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"}