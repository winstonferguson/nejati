{"version":3,"names":["_motionRuntimeTestContext","require","_lodash","_","_preset$query","preset","query","buildRequestTransformation","buildResponseTransformation","describe","test","requestQueryObjectPropertyName","aString","transformationString","expect","toStrictEqual","_times","times","responseMessageResultPath","responseMessagePagingMetadataPath","transformationObject","items","pagingMetadata","itemTransformation"],"sources":["../../../../../src/__tests__/transformations/preset/query-transformation.spec.ts"],"sourcesContent":["import { aString } from '@wix/motion-runtime-test-context';\nimport { times } from 'lodash';\n\nimport { preset } from '../../..';\n\nconst {\n  query: { buildRequestTransformation, buildResponseTransformation },\n} = preset;\n\ndescribe('query-method transformations', () => {\n  describe('buildRequestTransformation', () => {\n    // eslint-disable-next-line max-len\n    test('sets the query object as a property named via requestQueryObjectPropertyName, and spreads the 2nd argument', () => {\n      const requestQueryObjectPropertyName = aString();\n      const transformationString = buildRequestTransformation({\n        requestQueryObjectPropertyName,\n      });\n\n      expect(transformationString).toStrictEqual({\n        [requestQueryObjectPropertyName]: '$[0]',\n        '*': '$[1]',\n      });\n    });\n\n    // eslint-disable-next-line max-len\n    test(\"sets the given query tree under the 'query' property as a default, with the second argument spread into the payload\", () => {\n      const transformationString = buildRequestTransformation();\n\n      expect(transformationString).toStrictEqual({\n        query: '$[0]',\n        '*': '$[1]',\n      });\n    });\n  });\n\n  describe('buildResponseTransformation', () => {\n    const [responseMessageResultPath, responseMessagePagingMetadataPath] =\n      times(2, () => aString());\n\n    test('unwraps the value of the provided property-path', () => {\n      const transformationObject = buildResponseTransformation({\n        responseMessageResultPath,\n        responseMessagePagingMetadataPath,\n      });\n\n      expect(transformationObject).toStrictEqual({\n        items: `$.${responseMessageResultPath}`,\n        pagingMetadata: `$.${responseMessagePagingMetadataPath}`,\n      });\n    });\n\n    test('adds an item-transformation when provided', () => {\n      const itemTransformation = `$.some.path.${aString()}`;\n      const transformationObject = buildResponseTransformation({\n        responseMessageResultPath,\n        responseMessagePagingMetadataPath,\n        itemTransformation,\n      });\n\n      expect(transformationObject).toStrictEqual({\n        items: {\n          '@path': `$.${responseMessageResultPath}`,\n          '@itemTransformation': itemTransformation,\n        },\n        pagingMetadata: `$.${responseMessagePagingMetadataPath}`,\n      });\n    });\n  });\n});\n"],"mappings":";;AAAA,IAAAA,yBAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AAEA,IAAAE,CAAA,GAAAF,OAAA;AAEA,MAAAG,aAAA,GAEIC,QAAM,CADRC,KAAK;EAAIC,0BAA0B,GAAAH,aAAA,CAA1BG,0BAA0B;EAAEC,2BAA2B,GAAAJ,aAAA,CAA3BI,2BAA2B;AAGlEC,QAAQ,CAAC,8BAA8B,EAAE,MAAM;EAC7CA,QAAQ,CAAC,4BAA4B,EAAE,MAAM;IAC3C;IACAC,IAAI,CAAC,4GAA4G,EAAE,MAAM;MACvH,MAAMC,8BAA8B,GAAG,IAAAC,iCAAO,EAAC,CAAC;MAChD,MAAMC,oBAAoB,GAAGN,0BAA0B,CAAC;QACtDI;MACF,CAAC,CAAC;MAEFG,MAAM,CAACD,oBAAoB,CAAC,CAACE,aAAa,CAAC;QACzC,CAACJ,8BAA8B,GAAG,MAAM;QACxC,GAAG,EAAE;MACP,CAAC,CAAC;IACJ,CAAC,CAAC;;IAEF;IACAD,IAAI,CAAC,qHAAqH,EAAE,MAAM;MAChI,MAAMG,oBAAoB,GAAGN,0BAA0B,CAAC,CAAC;MAEzDO,MAAM,CAACD,oBAAoB,CAAC,CAACE,aAAa,CAAC;QACzCT,KAAK,EAAE,MAAM;QACb,GAAG,EAAE;MACP,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFG,QAAQ,CAAC,6BAA6B,EAAE,MAAM;IAC5C,MAAAO,MAAA,GACE,IAAAC,aAAK,EAAC,CAAC,EAAE,MAAM,IAAAL,iCAAO,EAAC,CAAC,CAAC;MADpBM,yBAAyB,GAAAF,MAAA;MAAEG,iCAAiC,GAAAH,MAAA;IAGnEN,IAAI,CAAC,iDAAiD,EAAE,MAAM;MAC5D,MAAMU,oBAAoB,GAAGZ,2BAA2B,CAAC;QACvDU,yBAAyB;QACzBC;MACF,CAAC,CAAC;MAEFL,MAAM,CAACM,oBAAoB,CAAC,CAACL,aAAa,CAAC;QACzCM,KAAK,EAAG,KAAIH,yBAA0B,EAAC;QACvCI,cAAc,EAAG,KAAIH,iCAAkC;MACzD,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFT,IAAI,CAAC,2CAA2C,EAAE,MAAM;MACtD,MAAMa,kBAAkB,GAAI,eAAc,IAAAX,iCAAO,EAAC,CAAE,EAAC;MACrD,MAAMQ,oBAAoB,GAAGZ,2BAA2B,CAAC;QACvDU,yBAAyB;QACzBC,iCAAiC;QACjCI;MACF,CAAC,CAAC;MAEFT,MAAM,CAACM,oBAAoB,CAAC,CAACL,aAAa,CAAC;QACzCM,KAAK,EAAE;UACL,OAAO,EAAG,KAAIH,yBAA0B,EAAC;UACzC,qBAAqB,EAAEK;QACzB,CAAC;QACDD,cAAc,EAAG,KAAIH,iCAAkC;MACzD,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC"}