{"version":3,"names":["_motionRuntimeTestContext","require","_lodash","_","_preset$update","preset","update","buildRequestTransformation","buildResponseTransformation","describe","requestMessageOptionsPath","aString","requestMessageEntityPath","requestMessageEntityIdentifierField","test","transformedObject","expect","toStrictEqual","requestMessageEntityPathSegments","times","optionsPathSegments","transformationObject","join","sharedPath","responseMessageResultPath","transformationString"],"sources":["../../../../../src/__tests__/transformations/preset/update-transformation.spec.ts"],"sourcesContent":["import { aString } from '@wix/motion-runtime-test-context';\nimport { times } from 'lodash';\n\nimport { preset } from '../../..';\n\nconst {\n  update: { buildRequestTransformation, buildResponseTransformation },\n} = preset;\n\ndescribe('update-method transformations', () => {\n  describe('buildRequestTransformation', () => {\n    const requestMessageOptionsPath = aString();\n    const requestMessageEntityPath = aString();\n    const requestMessageEntityIdentifierField = aString();\n\n    test('creates a transformation mapping args into requestMessageIdentifierPath and requestMessageEntityPath', () => {\n      const transformedObject = buildRequestTransformation({\n        requestMessageEntityIdentifierField,\n        requestMessageEntityPath,\n      });\n\n      expect(transformedObject).toStrictEqual({\n        [requestMessageEntityPath]: {\n          [requestMessageEntityIdentifierField]: '$[0]',\n          '*': '$[1]',\n        },\n      });\n    });\n\n    test(`creates a transformation that maps the 3rd argument into requestMessageOptionsPath when provided`, () => {\n      const transformedObject = buildRequestTransformation({\n        requestMessageEntityIdentifierField,\n        requestMessageEntityPath,\n        requestMessageOptionsPath,\n      });\n\n      expect(transformedObject).toStrictEqual({\n        [requestMessageEntityPath]: {\n          [requestMessageEntityIdentifierField]: '$[0]',\n          '*': '$[1]',\n        },\n        [requestMessageOptionsPath]: '$[2]',\n      });\n    });\n\n    test('supports nested paths for requestMessageEntityPath and requestMessageOptionsPath', () => {\n      // @ts-expect-error\n      const requestMessageEntityPathSegments = times(2, aString);\n      // @ts-expect-error\n      const optionsPathSegments = times(2, aString);\n\n      const transformationObject = buildRequestTransformation({\n        requestMessageEntityIdentifierField,\n        requestMessageEntityPath: requestMessageEntityPathSegments.join('.'),\n        requestMessageOptionsPath: optionsPathSegments.join('.'),\n      });\n\n      expect(transformationObject).toStrictEqual({\n        [requestMessageEntityPathSegments[0]]: {\n          [requestMessageEntityPathSegments[1]]: {\n            [requestMessageEntityIdentifierField]: '$[0]',\n            '*': '$[1]',\n          },\n        },\n        [optionsPathSegments[0]]: { [optionsPathSegments[1]]: '$[2]' },\n      });\n    });\n\n    test('supports shared paths for requestMessageEntityPath and requestMessageOptionsPath', () => {\n      const sharedPath = aString();\n\n      const transformationObject = buildRequestTransformation({\n        requestMessageEntityIdentifierField,\n        requestMessageEntityPath: sharedPath,\n        requestMessageOptionsPath: sharedPath,\n      });\n\n      expect(transformationObject).toStrictEqual({\n        [sharedPath]: {\n          [requestMessageEntityIdentifierField]: '$[0]',\n          '*': ['$[1]', '$[2]'],\n        },\n      });\n    });\n  });\n\n  describe('buildResponseTransformation', () => {\n    test('unwraps the value of the provided property-path', () => {\n      const responseMessageResultPath = aString();\n\n      const transformationString = buildResponseTransformation({\n        responseMessageResultPath,\n      });\n\n      expect(transformationString).toStrictEqual(\n        `$.${responseMessageResultPath}`,\n      );\n    });\n  });\n});\n"],"mappings":"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"}