{"version":3,"names":["_motionRuntimeTestContext","require","_","describe","otherPayloadFields","anObject","each","fromCorvidEntity","toCorvidEntity","transformer","test","aString","payload","expect","toStrictEqual","key","renamedKey","value","requestPayload","objectWithUnderscoreId","someArray","someUnaffectedObject","responsePayload"],"sources":["../../../src/__tests__/converters.spec.ts"],"sourcesContent":["import { anObject, aString } from '@wix/motion-runtime-test-context';\n\nimport { fromCorvidEntity, toCorvidEntity } from '..';\n\ndescribe('corvid entities transformers', () => {\n  const otherPayloadFields = anObject();\n\n  describe('common rules for both ways', () => {\n    describe.each`\n      transformer         | name\n      ${fromCorvidEntity} | ${'fromCorvidEntity'}\n      ${toCorvidEntity}   | ${'toCorvidEntity'}\n    `('$name', ({ transformer }) => {\n      test.each`\n        description                    | payload\n        ${'has no property to rename'} | ${anObject()}\n        ${'has a null property'}       | ${{ [aString()]: null }}\n        ${'is null'}                   | ${null}\n      `('does not modify the payload when it $description', ({ payload }) => {\n        expect(transformer(payload)).toStrictEqual(payload);\n      });\n    });\n  });\n\n  describe('specific renames from corvid entity', () => {\n    describe.each`\n      key               | renamedKey\n      ${'_id'}          | ${'id'}\n      ${'_createdDate'} | ${'createdDate'}\n      ${'_updatedDate'} | ${'updatedDate'}\n    `('$key', ({ key, renamedKey }) => {\n      describe.each`\n        description   | value\n        ${'a string'} | ${aString()}\n        ${'null'}     | ${null}\n      `(`with ${key} exists and is $description`, ({ value }) => {\n        test(`adds an ${renamedKey} property with the same value as the ${key} property`, () => {\n          const requestPayload = { ...otherPayloadFields, [key]: value };\n\n          expect(fromCorvidEntity(requestPayload)).toStrictEqual({\n            ...otherPayloadFields,\n            [renamedKey]: value,\n          });\n        });\n\n        test(`recursively adds ${renamedKey} to nested objects and arrays`, () => {\n          const objectWithUnderscoreId = {\n            ...otherPayloadFields,\n            [key]: value,\n          };\n          const requestPayload = {\n            someArray: [otherPayloadFields, objectWithUnderscoreId],\n          };\n\n          expect(fromCorvidEntity(requestPayload)).toStrictEqual({\n            someArray: [\n              otherPayloadFields,\n              { ...otherPayloadFields, [renamedKey]: value },\n            ],\n          });\n        });\n      });\n    });\n  });\n\n  describe('specific renames to corvid entity', () => {\n    describe.each`\n      key              | renamedKey\n      ${'id'}          | ${'_id'}\n      ${'createdDate'} | ${'_createdDate'}\n      ${'updatedDate'} | ${'_updatedDate'}\n    `('$key', ({ key, renamedKey }) => {\n      describe(`when ${key} exists in the response payload`, () => {\n        test.each`\n          description   | value\n          ${'a string'} | ${aString()}\n          ${'null'}     | ${null}\n        `(\n          'recursively adds it to nested objects and arrays when it is $description',\n          ({ value }) => {\n            const someUnaffectedObject = anObject();\n            const objectWithUnderscoreId = {\n              ...otherPayloadFields,\n              [key]: value,\n            };\n            const responsePayload = {\n              someArray: [someUnaffectedObject, objectWithUnderscoreId],\n            };\n\n            expect(toCorvidEntity(responsePayload)).toStrictEqual({\n              someArray: [\n                someUnaffectedObject,\n                { ...otherPayloadFields, [renamedKey]: value },\n              ],\n            });\n          },\n        );\n      });\n    });\n  });\n});\n"],"mappings":"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"}