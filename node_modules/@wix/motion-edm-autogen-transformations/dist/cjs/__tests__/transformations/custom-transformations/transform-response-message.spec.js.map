{"version":3,"names":["_motionEdmAutogenTransformationsCore","require","_motionRuntimeTestContext","_","RESPONSE_OBJECT_UNCHANGED","transformations","describe","test","responseObject","anObject","transformedReturnValue","transformResponseMessage","expect","toStrictEqual","someString","aString","someNumber","aNumber","someObject","objectKey","aRandomItemFrom","Object","keys","objectValue","firstArrayItem","lastArrayItemKey","lastArrayItemValue","lastArrayItem","someArray","each","transformation","expectedReturnValue","a","b","transformedPayload"],"sources":["../../../../../src/__tests__/transformations/custom-transformations/transform-response-message.spec.ts"],"sourcesContent":["import { transformations } from '@wix/motion-edm-autogen-transformations-core';\nimport {\n  anObject,\n  aNumber,\n  aRandomItemFrom,\n  aString,\n} from '@wix/motion-runtime-test-context';\n\nimport { transformResponseMessage } from '../../..';\n\nconst { RESPONSE_OBJECT_UNCHANGED } = transformations;\n\ndescribe('transforming a response JSON to a JS object', () => {\n  describe('the passthrough transformation', () => {\n    test('returns the object returned by the service as-is', () => {\n      const responseObject = anObject();\n\n      const transformedReturnValue = transformResponseMessage(\n        responseObject,\n        RESPONSE_OBJECT_UNCHANGED,\n      );\n\n      expect(transformedReturnValue).toStrictEqual(responseObject);\n    });\n  });\n\n  describe('non-identity transformations', () => {\n    const someString = aString();\n    const someNumber = aNumber();\n    const someObject = anObject();\n    const objectKey = aRandomItemFrom(Object.keys(someObject));\n    const objectValue = someObject[objectKey];\n    const firstArrayItem = aString();\n    const lastArrayItemKey = aString();\n    const lastArrayItemValue = aString();\n    const lastArrayItem = { [lastArrayItemKey]: lastArrayItemValue };\n    const someArray = [firstArrayItem, lastArrayItem];\n\n    const responseObject = { someNumber, someString, someObject, someArray };\n\n    describe('extracting a specific value from the response object', () => {\n      /* eslint-disable max-len */\n      test.each`\n        description                     | transformation                          | expectedReturnValue\n        ${'primitive value extraction'} | ${'$.someString'}                       | ${someString}\n        ${'object extraction'}          | ${'$.someObject'}                       | ${someObject}\n        ${'object property extraction'} | ${`$.someObject.${objectKey}`}          | ${objectValue}\n        ${'entire array extraction'}    | ${`$.someArray`}                        | ${someArray}\n        ${'array item'}                 | ${`$.someArray[0]`}                     | ${firstArrayItem}\n        ${'array item nested field'}    | ${`$.someArray[1].${lastArrayItemKey}`} | ${lastArrayItemValue}\n      `(\n        'extract a $description as a return value',\n        ({ transformation, expectedReturnValue }) => {\n          /* eslint-enable max-len */\n          const transformedReturnValue = transformResponseMessage(\n            responseObject,\n            transformation,\n          );\n\n          expect(transformedReturnValue).toStrictEqual(expectedReturnValue);\n        },\n      );\n    });\n\n    describe('mapping the response object to another object', () => {\n      /* eslint-disable max-len */\n      test.each`\n        description                          | transformation                                                    | expectedReturnValue\n        ${'primitive values'}                | ${{ a: '$.someString', b: '$.someNumber' }}                       | ${{ a: someString, b: someNumber }}\n        ${'an array'}                        | ${{ a: '$.someArray', b: '$.someNumber' }}                        | ${{ a: someArray, b: someNumber }}\n        ${'an array item'}                   | ${{ a: '$.someArray[0]', b: `$.someArray[1]` }}                   | ${{ a: firstArrayItem, b: lastArrayItem }}\n        ${'a nested field of an array item'} | ${{ a: '$.someString', b: `$.someArray[1].${lastArrayItemKey}` }} | ${{ a: someString, b: lastArrayItemValue }}\n        ${'an object'}                       | ${{ a: '$.someObject', b: '$.someNumber' }}                       | ${{ a: someObject, b: someNumber }}\n        ${'an object property value'}        | ${{ a: `$.someObject.${objectKey}`, b: '$.someNumber' }}          | ${{ a: objectValue, b: someNumber }}\n      `(\n        'map $description to the return-value object properties',\n        ({ transformation, expectedReturnValue }) => {\n          /* eslint-enable max-len */\n          const transformedPayload = transformResponseMessage(\n            responseObject,\n            transformation,\n          );\n\n          expect(transformedPayload).toStrictEqual(expectedReturnValue);\n        },\n      );\n    });\n  });\n});\n"],"mappings":"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"}